const CATALOG = [
    {
        id: 'el1',
        title: 'El 1 Title',
        img: 'https://images.unsplash.com/photo-1523005505536-da8021509536?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1050&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el2',
        title: 'El 2 Title',
        img: 'https://images.unsplash.com/photo-1585713181954-48d69dfb72e9?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=751&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el3',
        title: 'El 3 Title',
        img: 'https://images.unsplash.com/photo-1526335727645-74a18e4ffb2f?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=334&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el4',
        title: 'El 4 Title',
        img: 'https://images.unsplash.com/photo-1582033100694-e3727c22436f?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1976&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el5',
        title: 'El 5 Title',
        img: 'https://images.unsplash.com/photo-1522911715181-6ce196f07c76?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=401&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el6',
        title: 'El 6 Title',
        img: 'https://images.unsplash.com/photo-1585955353676-02a7e5a7bff1?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=375&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el7',
        title: 'El 7 Title',
        img: 'https://images.unsplash.com/photo-1617655213184-e37401a1c773?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el8',
        title: 'El 8 Title',
        img: 'https://images.unsplash.com/photo-1612993432369-d7e19aa6e3ed?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=400&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el9',
        title: 'El 9 Title',
        img: 'https://images.unsplash.com/photo-1610744717177-2dd62b7c6172?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el10',
        title: 'El 10 Title',
        img: 'https://images.unsplash.com/photo-1500687834377-1388ec3c5991?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=282&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el11',
        title: 'El 11 Title',
        img: 'https://images.unsplash.com/photo-1523005505536-da8021509536?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1050&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el12',
        title: 'El 12 Title',
        img: 'https://images.unsplash.com/photo-1585713181954-48d69dfb72e9?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=751&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el13',
        title: 'El 13 Title',
        img: 'https://images.unsplash.com/photo-1526335727645-74a18e4ffb2f?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=334&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el14',
        title: 'El 14 Title',
        img: 'https://images.unsplash.com/photo-1582033100694-e3727c22436f?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1976&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
    {
        id: 'el15',
        title: 'El 15 Title',
        img: 'https://images.unsplash.com/photo-1522911715181-6ce196f07c76?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=401&q=80',
        text: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Incidunt ab quia eum nihil a maxime nemo iusto sapiente doloribus nobis!",
        link: '#',
    },
];

const ROOT_HEADER = document.querySelector('#header')
const ROOT_MAIN = document.querySelector('#main')
class LocalStorageUtil {
    constructor() {
      this.keyName = 'main';
    }
    getMain() {
      const mainLocalStorage = localStorage.getItem(this.keyName);
      if (mainLocalStorage !== null) {
        return JSON.parse(mainLocalStorage);
      }
      return [];
    }
    putMain(id) {
      let main = this.getMain();
      let pushMain = false;
      const index = main.indexOf(id);
      if (index === -1) {
        main.push(id);
        pushMain = true;
      } else {
        main.splice(index, 1);
      }
      localStorage.setItem(this.keyName, JSON.stringify(main));
      return { pushMain, main };
    }
  }
  
  const localStorageUtil = new LocalStorageUtil();
  
class Main {

    constructor() {
        this.classNameActive = 'main__trash';
    }

    handleSetLocationStorage(element, id) {
        const { pushMain, main } = localStorageUtil.putMain(id);
        
        if (pushMain) {
            element.classList.add(this.classNameActive);
        } else {
            element.classList.remove(this.classNameActive);
        }
        headerPage.render(main.length);
    }


  render() {
    const mainStore = localStorageUtil.getMain();
    let htmlCatalog = '';

    CATALOG.forEach(({ id, title, text, img, link }) => {

        let activeClass = '';

        if (mainStore.indexOf(id) === -1) {
            activeClass = '';
        } else {
            activeClass = ' '+this.classNameActive;
        }
        
      htmlCatalog += `
                <li class="main__item">
                    <img src="${img}" alt="Img Title" class="main__pic" />
                    <div class="main__info">
                    <div class="main__wrapper">
                        <h2 class="main__title">${title}</h2>
                        <div class="main__add ${activeClass} main__ico" onclick="mainPage.handleSetLocationStorage(this,'${id}');"></div>
                    </div>
                    <p class="main__text">
                        ${text}
                    </p>
                    <a href="${link}" class="main__link">View experience</a>
                    </div>
                </li>
            `;
    });

    const html = `
        <div class="container">
            <ul class="main__wrap">
                ${htmlCatalog}
            </ul>
        </div>
        `;

    ROOT_MAIN.innerHTML = html;
  }
}

const mainPage = new Main();
mainPage.render();

class Header {
  burgerOpen() {
    const burger = document.querySelector('.header__burger');
    const menuList = document.querySelector('.header__right-wrap');
    const body = document.querySelector('body');
    burger.classList.toggle('active');
    menuList.classList.toggle('active');
    body.classList.toggle('lock');
  }


  /* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
  myFunction() {
    const dropdown = document.querySelector("#myDropdown");
    dropdown.classList.toggle("show");
  }


  render(count) {
    const html = `
        <div class="container">
          <div class="header__wrap">
            <a href="#" class="header__logo"></a>
            <div onclick="headerPage.burgerOpen();" class="header__burger">
              <span></span>
            </div>
            <div class="header__right-wrap">
              <nav class="header__nav-wrap">
                <ul class="header__nav">
                  <li class="header__nav-item"><a href="#">Experiences</a></li>
                  <li class="header__nav-item"><a href="#">Inspiration</a></li>
                  <li class="header__nav-item"><a href="#">Hearts(${count})</a></li>
                  <li class="header__nav-item"><a href="#">Cart(1)</a></li>
                </ul>
              </nav>
              <div class="dropdown">
                <button onclick="headerPage.myFunction()" class="dropbtn">English</button>
                <div id="myDropdown" class="header__dropdown dropdown-content">
                  <a href="#">Norsk</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        `;
    ROOT_HEADER.innerHTML = html;
  }
}

const headerPage = new Header();

const mainStore = localStorageUtil.getMain();
headerPage.render(mainStore.length);


    // Close the dropdown menu if the user clicks outside of it


// let window = document.querySelector('window'); 
console.log(window);
window.addEventListener('click', (event) => {
    if (!event.target.matches('.dropbtn')) {
        const dropdown = document.querySelector("#myDropdown");
        if (dropdown.classList.contains('show')) {
            dropdown.classList.remove('show');
        }
    }
})
